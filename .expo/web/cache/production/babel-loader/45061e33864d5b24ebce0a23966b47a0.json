{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import{Easing}from\"./Easing\";import{isColor,convertToHSVA,toRGBA}from\"./Colors\";import NativeReanimated from\"./NativeReanimated\";import Platform from\"react-native-web/dist/exports/Platform\";var IN_STYLE_UPDATER=false;export function initialUpdaterRun(updater){IN_STYLE_UPDATER=true;var result=updater();IN_STYLE_UPDATER=false;return result;}export function transform(value,handler){'worklet';if(value===undefined){return undefined;}if(typeof value==='string'){var match=value.match(/([A-Za-z]*)(-?\\d*\\.?\\d*)([A-Za-z%]*)/);var prefix=match[1];var suffix=match[3];var number=match[2];handler.__prefix=prefix;handler.__suffix=suffix;return parseFloat(number);}if(handler.__prefix===undefined){return value;}return handler.__prefix+value+handler.__suffix;}export function transformAnimation(animation){'worklet';if(!animation){return;}animation.toValue=transform(animation.toValue,animation);animation.current=transform(animation.current,animation);animation.startValue=transform(animation.startValue,animation);}export function decorateAnimation(animation){'worklet';if(animation.isHigherOrder){return;}var baseOnStart=animation.onStart;var baseOnFrame=animation.onFrame;var animationCopy=_extends({},animation);delete animationCopy.callback;var prefNumberSuffOnStart=function prefNumberSuffOnStart(animation,value,timestamp,previousAnimation){var val=transform(value,animation);transformAnimation(animation);if(previousAnimation!==animation)transformAnimation(previousAnimation);baseOnStart(animation,val,timestamp,previousAnimation);transformAnimation(animation);if(previousAnimation!==animation)transformAnimation(previousAnimation);};var prefNumberSuffOnFrame=function prefNumberSuffOnFrame(animation,timestamp){transformAnimation(animation);var res=baseOnFrame(animation,timestamp);transformAnimation(animation);return res;};var tab=['H','S','V','A'];var colorOnStart=function colorOnStart(animation,value,timestamp,previousAnimation){var HSVAValue;var HSVACurrent;var HSVAToValue;var res=[];if(isColor(value)){HSVACurrent=convertToHSVA(animation.current);HSVAValue=convertToHSVA(value);if(animation.toValue){HSVAToValue=convertToHSVA(animation.toValue);}}tab.forEach(function(i,index){animation[i]=_extends({},animationCopy);animation[i].current=HSVACurrent[index];animation[i].toValue=HSVAToValue?HSVAToValue[index]:undefined;animation[i].onStart(animation[i],HSVAValue[index],timestamp,previousAnimation?previousAnimation[i]:undefined);res.push(animation[i].current);});animation.current=toRGBA(res);};var colorOnFrame=function colorOnFrame(animation,timestamp){var HSVACurrent=convertToHSVA(animation.current);var res=[];var finished=true;tab.forEach(function(i,index){animation[i].current=HSVACurrent[index];finished&=animation[i].onFrame(animation[i],timestamp);res.push(animation[i].current);});animation.current=toRGBA(res);return finished;};animation.onStart=function(animation,value,timestamp,previousAnimation){if(isColor(value)){colorOnStart(animation,value,timestamp,previousAnimation);animation.onFrame=colorOnFrame;return;}else if(typeof value==='string'){prefNumberSuffOnStart(animation,value,timestamp,previousAnimation);animation.onFrame=prefNumberSuffOnFrame;return;}baseOnStart(animation,value,timestamp,previousAnimation);};}export function defineAnimation(starting,factory){'worklet';if(IN_STYLE_UPDATER){return starting;}var create=function create(){'worklet';var animation=factory();decorateAnimation(animation);return animation;};if(_WORKLET||!NativeReanimated.native){return create();}return create;}export function cancelAnimation(sharedValue){'worklet';sharedValue.value=sharedValue.value;}export function withTiming(toValue,userConfig,callback){'worklet';return defineAnimation(toValue,function(){'worklet';var config={duration:300,easing:Easing.inOut(Easing.quad)};if(userConfig){Object.keys(userConfig).forEach(function(key){return config[key]=userConfig[key];});}function timing(animation,now){var toValue=animation.toValue,progress=animation.progress,startTime=animation.startTime,current=animation.current;var runtime=now-startTime;if(runtime>=config.duration){animation.startTime=0;animation.current=toValue;return true;}var newProgress=config.easing(runtime/config.duration);var dist=(toValue-current)*(newProgress-progress)/(1-progress);animation.current+=dist;animation.progress=newProgress;return false;}function onStart(animation,value,now,previousAnimation){if(previousAnimation&&previousAnimation.type==='timing'&&previousAnimation.toValue===toValue&&previousAnimation.startTime){animation.startTime=previousAnimation.startTime;animation.progress=previousAnimation.progress;}else{animation.startTime=now;animation.progress=0;}animation.current=value;}return{type:'timing',onFrame:timing,onStart:onStart,progress:0,toValue:toValue,current:toValue,callback:callback};});}export function withSpring(toValue,userConfig,callback){'worklet';return defineAnimation(toValue,function(){'worklet';var config={damping:10,mass:1,stiffness:100,overshootClamping:false,restDisplacementThreshold:0.01,restSpeedThreshold:2};if(userConfig){Object.keys(userConfig).forEach(function(key){return config[key]=userConfig[key];});}function spring(animation,now){var toValue=animation.toValue,lastTimestamp=animation.lastTimestamp,current=animation.current,velocity=animation.velocity;var deltaTime=Math.min(now-lastTimestamp,64);animation.lastTimestamp=now;var c=config.damping;var m=config.mass;var k=config.stiffness;var v0=-velocity;var x0=toValue-current;var zeta=c/(2*Math.sqrt(k*m));var omega0=Math.sqrt(k/m);var omega1=omega0*Math.sqrt(1-Math.pow(zeta,2));var t=deltaTime/1000;var sin1=Math.sin(omega1*t);var cos1=Math.cos(omega1*t);var underDampedEnvelope=Math.exp(-zeta*omega0*t);var underDampedFrag1=underDampedEnvelope*(sin1*((v0+zeta*omega0*x0)/omega1)+x0*cos1);var underDampedPosition=toValue-underDampedFrag1;var underDampedVelocity=zeta*omega0*underDampedFrag1-underDampedEnvelope*(cos1*(v0+zeta*omega0*x0)-omega1*x0*sin1);var criticallyDampedEnvelope=Math.exp(-omega0*t);var criticallyDampedPosition=toValue-criticallyDampedEnvelope*(x0+(v0+omega0*x0)*t);var criticallyDampedVelocity=criticallyDampedEnvelope*(v0*(t*omega0-1)+t*x0*omega0*omega0);var isOvershooting=function isOvershooting(){if(config.overshootClamping&&config.stiffness!==0){return current<toValue?animation.current>toValue:animation.current<toValue;}else{return false;}};var isVelocity=Math.abs(velocity)<config.restSpeedThreshold;var isDisplacement=config.stiffness===0||Math.abs(toValue-current)<config.restDisplacementThreshold;if(zeta<1){animation.current=underDampedPosition;animation.velocity=underDampedVelocity;}else{animation.current=criticallyDampedPosition;animation.velocity=criticallyDampedVelocity;}if(isOvershooting()||isVelocity&&isDisplacement){if(config.stiffness!==0){animation.velocity=0;animation.current=toValue;}return true;}}function onStart(animation,value,now,previousAnimation){animation.current=value;if(previousAnimation){animation.velocity=previousAnimation.velocity||animation.velocity||0;animation.lastTimestamp=previousAnimation.lastTimestamp||now;}else{animation.lastTimestamp=now;}}return{onFrame:spring,onStart:onStart,toValue:toValue,velocity:config.velocity||0,current:toValue,callback:callback};});}export function withDecay(userConfig,callback){'worklet';return defineAnimation(0,function(){'worklet';var config={deceleration:0.998,velocityFactor:Platform.OS!=='web'?1:1000};if(userConfig){Object.keys(userConfig).forEach(function(key){return config[key]=userConfig[key];});}var VELOCITY_EPS=Platform.OS!=='web'?1:1/20;var SLOPE_FACTOR=0.1;function decay(animation,now){var lastTimestamp=animation.lastTimestamp,startTimestamp=animation.startTimestamp,initialVelocity=animation.initialVelocity,current=animation.current,velocity=animation.velocity;var deltaTime=Math.min(now-lastTimestamp,64);var v=velocity*Math.exp(-(1-config.deceleration)*(now-startTimestamp)*SLOPE_FACTOR);animation.current=current+v*config.velocityFactor*deltaTime/1000;animation.velocity=v;animation.lastTimestamp=now;if(config.clamp){if(initialVelocity<0&&animation.current<=config.clamp[0]){animation.current=config.clamp[0];return true;}else if(initialVelocity>0&&animation.current>=config.clamp[1]){animation.current=config.clamp[1];return true;}}if(Math.abs(v)<VELOCITY_EPS){return true;}}function validateConfig(){if(config.clamp){if(Array.isArray(config.clamp)){if(config.clamp.length!==2){console.error(\"clamp array must contain 2 items but is given \"+config.clamp.length);}}else{console.error(\"config.clamp must be an array but is \"+typeof config.clamp);}}if(config.velocityFactor<=0){console.error(\"config.velocityFactor must be greather then 0 but is \"+config.velocityFactor);}}function onStart(animation,value,now){animation.current=value;animation.lastTimestamp=now;animation.startTimestamp=now;animation.initialVelocity=config.velocity;validateConfig();}return{onFrame:decay,onStart:onStart,velocity:config.velocity||0,callback:callback};});}export function withDelay(delayMs,_nextAnimation){'worklet';return defineAnimation(_nextAnimation,function(){'worklet';var nextAnimation=typeof _nextAnimation==='function'?_nextAnimation():_nextAnimation;function delay(animation,now){var startTime=animation.startTime,started=animation.started,previousAnimation=animation.previousAnimation;if(now-startTime>delayMs){if(!started){nextAnimation.onStart(nextAnimation,animation.current,now,previousAnimation);animation.previousAnimation=null;animation.started=true;}var finished=nextAnimation.onFrame(nextAnimation,now);animation.current=nextAnimation.current;return finished;}else if(previousAnimation){var _finished=previousAnimation.onFrame(previousAnimation,now);animation.current=previousAnimation.current;if(_finished){animation.previousAnimation=null;}}return false;}function onStart(animation,value,now,previousAnimation){animation.startTime=now;animation.started=false;animation.current=value;animation.previousAnimation=previousAnimation;}var callback=function callback(finished){if(nextAnimation.callback){nextAnimation.callback(finished);}};return{isHigherOrder:true,onFrame:delay,onStart:onStart,current:nextAnimation.current,callback:callback};});}export function withSequence(){'worklet';for(var _len=arguments.length,_animations=new Array(_len),_key=0;_key<_len;_key++){_animations[_key]=arguments[_key];}return defineAnimation(_animations[0],function(){'worklet';var animations=_animations.map(function(a){var result=typeof a==='function'?a():a;result.finished=false;return result;});var firstAnimation=animations[0];var callback=function callback(finished){if(finished){return;}animations.forEach(function(animation){if(typeof animation.callback==='function'&&!animation.finished){animation.callback(finished);}});};function sequence(animation,now){var currentAnim=animations[animation.animationIndex];var finished=currentAnim.onFrame(currentAnim,now);animation.current=currentAnim.current;if(finished){if(currentAnim.callback){currentAnim.callback(true);}currentAnim.finished=true;animation.animationIndex+=1;if(animation.animationIndex<animations.length){var nextAnim=animations[animation.animationIndex];nextAnim.onStart(nextAnim,currentAnim.current,now,currentAnim);return false;}return true;}return false;}function onStart(animation,value,now,previousAnimation){if(animations.length===1){throw Error('withSequence() animation require more than one animation as argument');}animation.animationIndex=0;if(previousAnimation===undefined){previousAnimation=animations[animations.length-1];}firstAnimation.onStart(firstAnimation,value,now,previousAnimation);}return{isHigherOrder:true,onFrame:sequence,onStart:onStart,animationIndex:0,current:firstAnimation.current,callback:callback};});}export function withRepeat(_nextAnimation){'worklet';var numberOfReps=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;var reverse=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var callback=arguments.length>3?arguments[3]:undefined;return defineAnimation(_nextAnimation,function(){'worklet';var nextAnimation=typeof _nextAnimation==='function'?_nextAnimation():_nextAnimation;function repeat(animation,now){var finished=nextAnimation.onFrame(nextAnimation,now);animation.current=nextAnimation.current;if(finished){animation.reps+=1;if(nextAnimation.callback){nextAnimation.callback(true,animation.current);}if(numberOfReps>0&&animation.reps>=numberOfReps){return true;}var startValue=reverse?nextAnimation.current:animation.startValue;if(reverse){nextAnimation.toValue=animation.startValue;animation.startValue=startValue;}nextAnimation.onStart(nextAnimation,startValue,now,nextAnimation.previousAnimation);return false;}return false;}var repCallback=function repCallback(finished){if(callback){callback(finished);}if(!finished&&nextAnimation.callback){nextAnimation.callback(false);}};function onStart(animation,value,now,previousAnimation){animation.startValue=value;animation.reps=0;nextAnimation.onStart(nextAnimation,value,now,previousAnimation);}return{isHigherOrder:true,onFrame:repeat,onStart:onStart,reps:0,current:nextAnimation.current,callback:repCallback};});}export function delay(delayMs,_nextAnimation){'worklet';console.warn('Method `delay` is deprecated. Please use `withDelay` instead');return withDelay(delayMs,_nextAnimation);}export function repeat(_nextAnimation){'worklet';var numberOfReps=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;var reverse=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var callback=arguments.length>3?arguments[3]:undefined;console.warn('Method `repeat` is deprecated. Please use `withRepeat` instead');return withRepeat(_nextAnimation,numberOfReps,reverse,callback);}export function loop(nextAnimation){'worklet';var numberOfLoops=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;console.warn('Method `loop` is deprecated. Please use `withRepeat` instead');return repeat(nextAnimation,Math.round(numberOfLoops*2),true);}export function sequence(){'worklet';console.warn('Method `sequence` is deprecated. Please use `withSequence` instead');return withSequence.apply(void 0,arguments);}","map":{"version":3,"sources":["/Users/finnbeardmore/Documents/GitHub/ITCrowd/node_modules/react-native-reanimated/lib/reanimated2/animations.js"],"names":["Easing","isColor","convertToHSVA","toRGBA","NativeReanimated","IN_STYLE_UPDATER","initialUpdaterRun","updater","result","transform","value","handler","undefined","match","prefix","suffix","number","__prefix","__suffix","parseFloat","transformAnimation","animation","toValue","current","startValue","decorateAnimation","isHigherOrder","baseOnStart","onStart","baseOnFrame","onFrame","animationCopy","callback","prefNumberSuffOnStart","timestamp","previousAnimation","val","prefNumberSuffOnFrame","res","tab","colorOnStart","HSVAValue","HSVACurrent","HSVAToValue","forEach","i","index","push","colorOnFrame","finished","defineAnimation","starting","factory","create","_WORKLET","native","cancelAnimation","sharedValue","withTiming","userConfig","config","duration","easing","inOut","quad","Object","keys","key","timing","now","progress","startTime","runtime","newProgress","dist","type","withSpring","damping","mass","stiffness","overshootClamping","restDisplacementThreshold","restSpeedThreshold","spring","lastTimestamp","velocity","deltaTime","Math","min","c","m","k","v0","x0","zeta","sqrt","omega0","omega1","pow","t","sin1","sin","cos1","cos","underDampedEnvelope","exp","underDampedFrag1","underDampedPosition","underDampedVelocity","criticallyDampedEnvelope","criticallyDampedPosition","criticallyDampedVelocity","isOvershooting","isVelocity","abs","isDisplacement","withDecay","deceleration","velocityFactor","Platform","OS","VELOCITY_EPS","SLOPE_FACTOR","decay","startTimestamp","initialVelocity","v","clamp","validateConfig","Array","isArray","length","console","error","withDelay","delayMs","_nextAnimation","nextAnimation","delay","started","withSequence","_animations","animations","map","a","firstAnimation","sequence","currentAnim","animationIndex","nextAnim","Error","withRepeat","numberOfReps","reverse","repeat","reps","repCallback","warn","loop","numberOfLoops","round"],"mappings":"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","sourcesContent":["/* global _WORKLET */\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-nocheck\nimport { Easing } from './Easing';\nimport { isColor, convertToHSVA, toRGBA } from './Colors';\nimport NativeReanimated from './NativeReanimated';\nimport { Platform } from 'react-native';\nlet IN_STYLE_UPDATER = false;\nexport function initialUpdaterRun(updater) {\n    IN_STYLE_UPDATER = true;\n    const result = updater();\n    IN_STYLE_UPDATER = false;\n    return result;\n}\nexport function transform(value, handler) {\n    'worklet';\n    if (value === undefined) {\n        return undefined;\n    }\n    if (typeof value === 'string') {\n        // toInt\n        // TODO handle color\n        const match = value.match(/([A-Za-z]*)(-?\\d*\\.?\\d*)([A-Za-z%]*)/);\n        const prefix = match[1];\n        const suffix = match[3];\n        const number = match[2];\n        handler.__prefix = prefix;\n        handler.__suffix = suffix;\n        return parseFloat(number);\n    }\n    // toString if __prefix is available and number otherwise\n    if (handler.__prefix === undefined) {\n        return value;\n    }\n    return handler.__prefix + value + handler.__suffix;\n}\nexport function transformAnimation(animation) {\n    'worklet';\n    if (!animation) {\n        return;\n    }\n    animation.toValue = transform(animation.toValue, animation);\n    animation.current = transform(animation.current, animation);\n    animation.startValue = transform(animation.startValue, animation);\n}\nexport function decorateAnimation(animation) {\n    'worklet';\n    if (animation.isHigherOrder) {\n        return;\n    }\n    const baseOnStart = animation.onStart;\n    const baseOnFrame = animation.onFrame;\n    const animationCopy = Object.assign({}, animation);\n    delete animationCopy.callback;\n    const prefNumberSuffOnStart = (animation, value, timestamp, previousAnimation) => {\n        const val = transform(value, animation);\n        transformAnimation(animation);\n        if (previousAnimation !== animation)\n            transformAnimation(previousAnimation);\n        baseOnStart(animation, val, timestamp, previousAnimation);\n        transformAnimation(animation);\n        if (previousAnimation !== animation)\n            transformAnimation(previousAnimation);\n    };\n    const prefNumberSuffOnFrame = (animation, timestamp) => {\n        transformAnimation(animation);\n        const res = baseOnFrame(animation, timestamp);\n        transformAnimation(animation);\n        return res;\n    };\n    const tab = ['H', 'S', 'V', 'A'];\n    const colorOnStart = (animation, value, timestamp, previousAnimation) => {\n        let HSVAValue;\n        let HSVACurrent;\n        let HSVAToValue;\n        const res = [];\n        if (isColor(value)) {\n            HSVACurrent = convertToHSVA(animation.current);\n            HSVAValue = convertToHSVA(value);\n            if (animation.toValue) {\n                HSVAToValue = convertToHSVA(animation.toValue);\n            }\n        }\n        tab.forEach((i, index) => {\n            animation[i] = Object.assign({}, animationCopy);\n            animation[i].current = HSVACurrent[index];\n            animation[i].toValue = HSVAToValue ? HSVAToValue[index] : undefined;\n            animation[i].onStart(animation[i], HSVAValue[index], timestamp, previousAnimation ? previousAnimation[i] : undefined);\n            res.push(animation[i].current);\n        });\n        animation.current = toRGBA(res);\n    };\n    const colorOnFrame = (animation, timestamp) => {\n        const HSVACurrent = convertToHSVA(animation.current);\n        const res = [];\n        let finished = true;\n        tab.forEach((i, index) => {\n            animation[i].current = HSVACurrent[index];\n            finished &= animation[i].onFrame(animation[i], timestamp);\n            res.push(animation[i].current);\n        });\n        animation.current = toRGBA(res);\n        return finished;\n    };\n    animation.onStart = (animation, value, timestamp, previousAnimation) => {\n        if (isColor(value)) {\n            colorOnStart(animation, value, timestamp, previousAnimation);\n            animation.onFrame = colorOnFrame;\n            return;\n        }\n        else if (typeof value === 'string') {\n            prefNumberSuffOnStart(animation, value, timestamp, previousAnimation);\n            animation.onFrame = prefNumberSuffOnFrame;\n            return;\n        }\n        baseOnStart(animation, value, timestamp, previousAnimation);\n    };\n}\nexport function defineAnimation(starting, factory) {\n    'worklet';\n    if (IN_STYLE_UPDATER) {\n        return starting;\n    }\n    const create = () => {\n        'worklet';\n        const animation = factory();\n        decorateAnimation(animation);\n        return animation;\n    };\n    if (_WORKLET || !NativeReanimated.native) {\n        return create();\n    }\n    return create;\n}\nexport function cancelAnimation(sharedValue) {\n    'worklet';\n    // setting the current value cancels the animation if one is currently running\n    sharedValue.value = sharedValue.value; // eslint-disable-line no-self-assign\n}\nexport function withTiming(toValue, userConfig, callback) {\n    'worklet';\n    return defineAnimation(toValue, () => {\n        'worklet';\n        const config = {\n            duration: 300,\n            easing: Easing.inOut(Easing.quad),\n        };\n        if (userConfig) {\n            Object.keys(userConfig).forEach((key) => (config[key] = userConfig[key]));\n        }\n        function timing(animation, now) {\n            const { toValue, progress, startTime, current } = animation;\n            const runtime = now - startTime;\n            if (runtime >= config.duration) {\n                // reset startTime to avoid reusing finished animation config in `start` method\n                animation.startTime = 0;\n                animation.current = toValue;\n                return true;\n            }\n            const newProgress = config.easing(runtime / config.duration);\n            const dist = ((toValue - current) * (newProgress - progress)) / (1 - progress);\n            animation.current += dist;\n            animation.progress = newProgress;\n            return false;\n        }\n        function onStart(animation, value, now, previousAnimation) {\n            if (previousAnimation &&\n                previousAnimation.type === 'timing' &&\n                previousAnimation.toValue === toValue &&\n                previousAnimation.startTime) {\n                // to maintain continuity of timing animations we check if we are starting\n                // new timing over the old one with the same parameters. If so, we want\n                // to copy animation timeline properties\n                animation.startTime = previousAnimation.startTime;\n                animation.progress = previousAnimation.progress;\n            }\n            else {\n                animation.startTime = now;\n                animation.progress = 0;\n            }\n            animation.current = value;\n        }\n        return {\n            type: 'timing',\n            onFrame: timing,\n            onStart,\n            progress: 0,\n            toValue,\n            current: toValue,\n            callback,\n        };\n    });\n}\nexport function withSpring(toValue, userConfig, callback) {\n    'worklet';\n    return defineAnimation(toValue, () => {\n        'worklet';\n        // TODO: figure out why we can't use spread or Object.assign here\n        // when user config is \"frozen object\" we can't enumerate it (perhaps\n        // something is wrong with the object prototype).\n        const config = {\n            damping: 10,\n            mass: 1,\n            stiffness: 100,\n            overshootClamping: false,\n            restDisplacementThreshold: 0.01,\n            restSpeedThreshold: 2,\n        };\n        if (userConfig) {\n            Object.keys(userConfig).forEach((key) => (config[key] = userConfig[key]));\n        }\n        function spring(animation, now) {\n            const { toValue, lastTimestamp, current, velocity } = animation;\n            const deltaTime = Math.min(now - lastTimestamp, 64);\n            animation.lastTimestamp = now;\n            const c = config.damping;\n            const m = config.mass;\n            const k = config.stiffness;\n            const v0 = -velocity;\n            const x0 = toValue - current;\n            const zeta = c / (2 * Math.sqrt(k * m)); // damping ratio\n            const omega0 = Math.sqrt(k / m); // undamped angular frequency of the oscillator (rad/ms)\n            const omega1 = omega0 * Math.sqrt(1 - Math.pow(zeta, 2)); // exponential decay\n            const t = deltaTime / 1000;\n            const sin1 = Math.sin(omega1 * t);\n            const cos1 = Math.cos(omega1 * t);\n            // under damped\n            const underDampedEnvelope = Math.exp(-zeta * omega0 * t);\n            const underDampedFrag1 = underDampedEnvelope *\n                (sin1 * ((v0 + zeta * omega0 * x0) / omega1) + x0 * cos1);\n            const underDampedPosition = toValue - underDampedFrag1;\n            // This looks crazy -- it's actually just the derivative of the oscillation function\n            const underDampedVelocity = zeta * omega0 * underDampedFrag1 -\n                underDampedEnvelope *\n                    (cos1 * (v0 + zeta * omega0 * x0) - omega1 * x0 * sin1);\n            // critically damped\n            const criticallyDampedEnvelope = Math.exp(-omega0 * t);\n            const criticallyDampedPosition = toValue - criticallyDampedEnvelope * (x0 + (v0 + omega0 * x0) * t);\n            const criticallyDampedVelocity = criticallyDampedEnvelope *\n                (v0 * (t * omega0 - 1) + t * x0 * omega0 * omega0);\n            const isOvershooting = () => {\n                if (config.overshootClamping && config.stiffness !== 0) {\n                    return current < toValue\n                        ? animation.current > toValue\n                        : animation.current < toValue;\n                }\n                else {\n                    return false;\n                }\n            };\n            const isVelocity = Math.abs(velocity) < config.restSpeedThreshold;\n            const isDisplacement = config.stiffness === 0 ||\n                Math.abs(toValue - current) < config.restDisplacementThreshold;\n            if (zeta < 1) {\n                animation.current = underDampedPosition;\n                animation.velocity = underDampedVelocity;\n            }\n            else {\n                animation.current = criticallyDampedPosition;\n                animation.velocity = criticallyDampedVelocity;\n            }\n            if (isOvershooting() || (isVelocity && isDisplacement)) {\n                if (config.stiffness !== 0) {\n                    animation.velocity = 0;\n                    animation.current = toValue;\n                }\n                return true;\n            }\n        }\n        function onStart(animation, value, now, previousAnimation) {\n            animation.current = value;\n            if (previousAnimation) {\n                animation.velocity =\n                    previousAnimation.velocity || animation.velocity || 0;\n                animation.lastTimestamp = previousAnimation.lastTimestamp || now;\n            }\n            else {\n                animation.lastTimestamp = now;\n            }\n        }\n        return {\n            onFrame: spring,\n            onStart,\n            toValue,\n            velocity: config.velocity || 0,\n            current: toValue,\n            callback,\n        };\n    });\n}\nexport function withDecay(userConfig, callback) {\n    'worklet';\n    return defineAnimation(0, () => {\n        'worklet';\n        const config = {\n            deceleration: 0.998,\n            velocityFactor: Platform.OS !== 'web' ? 1 : 1000,\n        };\n        if (userConfig) {\n            Object.keys(userConfig).forEach((key) => (config[key] = userConfig[key]));\n        }\n        const VELOCITY_EPS = Platform.OS !== 'web' ? 1 : 1 / 20;\n        const SLOPE_FACTOR = 0.1;\n        function decay(animation, now) {\n            const { lastTimestamp, startTimestamp, initialVelocity, current, velocity, } = animation;\n            const deltaTime = Math.min(now - lastTimestamp, 64);\n            const v = velocity *\n                Math.exp(-(1 - config.deceleration) * (now - startTimestamp) * SLOPE_FACTOR);\n            animation.current =\n                current + (v * config.velocityFactor * deltaTime) / 1000; // /1000 because time is in ms not in s\n            animation.velocity = v;\n            animation.lastTimestamp = now;\n            if (config.clamp) {\n                if (initialVelocity < 0 && animation.current <= config.clamp[0]) {\n                    animation.current = config.clamp[0];\n                    return true;\n                }\n                else if (initialVelocity > 0 &&\n                    animation.current >= config.clamp[1]) {\n                    animation.current = config.clamp[1];\n                    return true;\n                }\n            }\n            if (Math.abs(v) < VELOCITY_EPS) {\n                return true;\n            }\n        }\n        function validateConfig() {\n            if (config.clamp) {\n                if (Array.isArray(config.clamp)) {\n                    if (config.clamp.length !== 2) {\n                        console.error(`clamp array must contain 2 items but is given ${config.clamp.length}`);\n                    }\n                }\n                else {\n                    console.error(`config.clamp must be an array but is ${typeof config.clamp}`);\n                }\n            }\n            if (config.velocityFactor <= 0) {\n                console.error(`config.velocityFactor must be greather then 0 but is ${config.velocityFactor}`);\n            }\n        }\n        function onStart(animation, value, now) {\n            animation.current = value;\n            animation.lastTimestamp = now;\n            animation.startTimestamp = now;\n            animation.initialVelocity = config.velocity;\n            validateConfig();\n        }\n        return {\n            onFrame: decay,\n            onStart,\n            velocity: config.velocity || 0,\n            callback,\n        };\n    });\n}\nexport function withDelay(delayMs, _nextAnimation) {\n    'worklet';\n    return defineAnimation(_nextAnimation, () => {\n        'worklet';\n        const nextAnimation = typeof _nextAnimation === 'function' ? _nextAnimation() : _nextAnimation;\n        function delay(animation, now) {\n            const { startTime, started, previousAnimation } = animation;\n            if (now - startTime > delayMs) {\n                if (!started) {\n                    nextAnimation.onStart(nextAnimation, animation.current, now, previousAnimation);\n                    animation.previousAnimation = null;\n                    animation.started = true;\n                }\n                const finished = nextAnimation.onFrame(nextAnimation, now);\n                animation.current = nextAnimation.current;\n                return finished;\n            }\n            else if (previousAnimation) {\n                const finished = previousAnimation.onFrame(previousAnimation, now);\n                animation.current = previousAnimation.current;\n                if (finished) {\n                    animation.previousAnimation = null;\n                }\n            }\n            return false;\n        }\n        function onStart(animation, value, now, previousAnimation) {\n            animation.startTime = now;\n            animation.started = false;\n            animation.current = value;\n            animation.previousAnimation = previousAnimation;\n        }\n        const callback = (finished) => {\n            if (nextAnimation.callback) {\n                nextAnimation.callback(finished);\n            }\n        };\n        return {\n            isHigherOrder: true,\n            onFrame: delay,\n            onStart,\n            current: nextAnimation.current,\n            callback,\n        };\n    });\n}\nexport function withSequence(..._animations) {\n    'worklet';\n    return defineAnimation(_animations[0], () => {\n        'worklet';\n        const animations = _animations.map((a) => {\n            const result = typeof a === 'function' ? a() : a;\n            result.finished = false;\n            return result;\n        });\n        const firstAnimation = animations[0];\n        const callback = (finished) => {\n            if (finished) {\n                // we want to call the callback after every single animation\n                // not after all of them\n                return;\n            }\n            // this is going to be called only if sequence has been cancelled\n            animations.forEach((animation) => {\n                if (typeof animation.callback === 'function' && !animation.finished) {\n                    animation.callback(finished);\n                }\n            });\n        };\n        function sequence(animation, now) {\n            const currentAnim = animations[animation.animationIndex];\n            const finished = currentAnim.onFrame(currentAnim, now);\n            animation.current = currentAnim.current;\n            if (finished) {\n                // we want to call the callback after every single animation\n                if (currentAnim.callback) {\n                    currentAnim.callback(true /* finished */);\n                }\n                currentAnim.finished = true;\n                animation.animationIndex += 1;\n                if (animation.animationIndex < animations.length) {\n                    const nextAnim = animations[animation.animationIndex];\n                    nextAnim.onStart(nextAnim, currentAnim.current, now, currentAnim);\n                    return false;\n                }\n                return true;\n            }\n            return false;\n        }\n        function onStart(animation, value, now, previousAnimation) {\n            if (animations.length === 1) {\n                throw Error('withSequence() animation require more than one animation as argument');\n            }\n            animation.animationIndex = 0;\n            if (previousAnimation === undefined) {\n                previousAnimation = animations[animations.length - 1];\n            }\n            firstAnimation.onStart(firstAnimation, value, now, previousAnimation);\n        }\n        return {\n            isHigherOrder: true,\n            onFrame: sequence,\n            onStart,\n            animationIndex: 0,\n            current: firstAnimation.current,\n            callback,\n        };\n    });\n}\nexport function withRepeat(_nextAnimation, numberOfReps = 2, reverse = false, callback) {\n    'worklet';\n    return defineAnimation(_nextAnimation, () => {\n        'worklet';\n        const nextAnimation = typeof _nextAnimation === 'function' ? _nextAnimation() : _nextAnimation;\n        function repeat(animation, now) {\n            const finished = nextAnimation.onFrame(nextAnimation, now);\n            animation.current = nextAnimation.current;\n            if (finished) {\n                animation.reps += 1;\n                // call inner animation's callback on every repetition\n                // as the second argument the animation's current value is passed\n                if (nextAnimation.callback) {\n                    nextAnimation.callback(true /* finished */, animation.current);\n                }\n                if (numberOfReps > 0 && animation.reps >= numberOfReps) {\n                    return true;\n                }\n                const startValue = reverse\n                    ? nextAnimation.current\n                    : animation.startValue;\n                if (reverse) {\n                    nextAnimation.toValue = animation.startValue;\n                    animation.startValue = startValue;\n                }\n                nextAnimation.onStart(nextAnimation, startValue, now, nextAnimation.previousAnimation);\n                return false;\n            }\n            return false;\n        }\n        const repCallback = (finished) => {\n            if (callback) {\n                callback(finished);\n            }\n            // when cancelled call inner animation's callback\n            if (!finished && nextAnimation.callback) {\n                nextAnimation.callback(false /* finished */);\n            }\n        };\n        function onStart(animation, value, now, previousAnimation) {\n            animation.startValue = value;\n            animation.reps = 0;\n            nextAnimation.onStart(nextAnimation, value, now, previousAnimation);\n        }\n        return {\n            isHigherOrder: true,\n            onFrame: repeat,\n            onStart,\n            reps: 0,\n            current: nextAnimation.current,\n            callback: repCallback,\n        };\n    });\n}\n/* Deprecated section, kept for backward compatibility. Will be removed soon */\nexport function delay(delayMs, _nextAnimation) {\n    'worklet';\n    console.warn('Method `delay` is deprecated. Please use `withDelay` instead');\n    return withDelay(delayMs, _nextAnimation);\n}\nexport function repeat(_nextAnimation, numberOfReps = 2, reverse = false, callback) {\n    'worklet';\n    console.warn('Method `repeat` is deprecated. Please use `withRepeat` instead');\n    return withRepeat(_nextAnimation, numberOfReps, reverse, callback);\n}\nexport function loop(nextAnimation, numberOfLoops = 1) {\n    'worklet';\n    console.warn('Method `loop` is deprecated. Please use `withRepeat` instead');\n    return repeat(nextAnimation, Math.round(numberOfLoops * 2), true);\n}\nexport function sequence(..._animations) {\n    'worklet';\n    console.warn('Method `sequence` is deprecated. Please use `withSequence` instead');\n    return withSequence(..._animations);\n}\n/* Deprecated section end */\n"]},"metadata":{},"sourceType":"module"}